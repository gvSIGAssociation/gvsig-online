{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}

{% block content %}	  	
<div class="row">
	<div class="col-md-12">
		<div class="box">
		
			<div class="box-header with-border">
				<h3 class="box-title">{% trans "Style list" %}</h3>
			</div>
			
			<div class="box-body">
				<table class="table" id="layers-table">
					<thead>
						<tr>
							<th>ID</th>
						    <th>{% trans "Biblioteca" %}</th>
						    <th>{% trans "Descripción" %}</th>
						    <th>{% trans "¿es pública?" %}</th>
						    <th></th>
						    <th></th>
						</tr>
					</thead>
					<tbody>
						{% for library in libraries %}
							<tr>
								<td>{{ library.id }}</td>
							    <td>{{ library.title }}</td>
								<td>{{ library.description }}</td>
								<td>{{ library.is_public }}</td>
								<td></td>
								<td></td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>	
{% endblock %}

{% block content %}	  	
<div class="row">
	<a href="/gvsigonline/library_add/" class="waves-effect waves-green btn blue right" style="margin-top: 20px; margin-right: 10px;">{% trans "Add library" %}</a>
	<a href="/gvsigonline/library_upload/" class="waves-effect waves-green btn blue right" style="margin-top: 20px; margin-right: 10px;">{% trans "Import library" %}</a>
</div>

<div class="dash-content">
<div class="section">
<div class="dash-content symbology">
	<table class="table" id="layers-table">
		<thead>
			<tr>
				<th>ID</th>
			    <th>{% trans "Biblioteca" %}</th>
			    <th>{% trans "Descripción" %}</th>
			    <th>{% trans "¿es pública?" %}</th>
			    <th></th>
			    <th></th>
			</tr>
		</thead>
		<tbody>
			{% for library in libraries %}
				<tr>
					<td>{{ library.id }}</td>
				    <td>{{ library.title }}</td>
					<td>{{ library.description }}</td>
					<td>{{ library.is_public }}</td>
					<td></td>
					<td></td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
</div>
</div>
	  	
{% endblock %}

{% block extra-scripts %}
<script>
$(document).ready(function() {
	var table = $('#layers-table').DataTable({
		responsive: true,
	    language: {
	    	processing		: '{% trans "Processing request..." %}',
		    search			: '{% blocktrans with sep="&nbsp;:" %}Search{{sep}}{% endblocktrans %}',
		    lengthMenu		: '{% blocktrans with numrecords="_MENU_" %}Showing {{numrecords}} records{% endblocktrans %}',
		    info			: '{% blocktrans with start="_START_" end="_END_" numrecords="_TOTAL_" %}Showing from {{start}} to {{end}} of {{numrecords}} records{% endblocktrans %}',
		    infoEmpty		: '{% trans "Showing from 0 to 0 of 0 records" %}',
		    infoFiltered	: '{% blocktrans with max="_MAX_" %}Filtering {{max}} records{% endblocktrans %}',
		    infoPostFix		: "",
		    loadingRecords	: '{% trans "Loading..." %}',
		    zeroRecords		: '{% trans "No records available" %}',
		    emptyTable		: '{% trans "No records available" %}',
		    paginate: {
		        first		: '{% trans "First" %}',
		        previous	: '{% trans "Previous" %}',
		        next		: '{% trans "Next" %}',
		   		last		: '{% trans "Last" %}'
		 	},
		  	aria: {
		     	sortAscending: '{% blocktrans with sep=": " %}{{sep}}Sort ascending{% endblocktrans %}',
		        sortDescending: '{% blocktrans with sep=": " %}{{sep}}Sort descending{% endblocktrans %}'
		    }
		},
		"columnDefs": [{
	      	"targets": -2,
	       	"data": function ( row, type, val, meta ) {
      			if (row[3] == "False"){
      				return '<button type="button" name="button-update-library" data-toggle="tooltip" data-placement="bottom" title="' + '{% trans "Update library" %}' + '" class="btn-floating btn-flat waves-effect waves-light light-green"><i class="fa fa-edit"></i></button>'
      			}else{
      				return '<button type="button" name="button-update-library" data-toggle="tooltip" data-placement="bottom" title="' + '{% trans "view library" %}' + '" class="btn-floating btn-flat waves-effect waves-light light-green"><i class="fa fa-search"></i></button>'
      			}     
   			 },
	        "defaultContent": '<button type="button" name="button-update-library" data-toggle="tooltip" data-placement="bottom" title="' + '{% trans "Update library" %}' + '" class="btn-floating btn-flat waves-effect waves-light light-green"><i class="fa fa-edit"></i></button>'
	  	},{
	      	"targets": -1,
	       	"data": function ( row, type, val, meta ) {
      			if (row[3] == "False"){
      				return '<button type="button" name="button-remove-library" data-toggle="tooltip" data-placement="bottom" title="' + '{% trans "Remove library" %}' + '" class="btn-floating btn-flat waves-effect waves-light red"><i class="fa fa-times"></i></button>';
      			}else{
      				return ''
      			}     
   			 },
	        "defaultContent": '<button type="button" name="button-remove-library" data-toggle="tooltip" data-placement="bottom" title="' + '{% trans "Remove library" %}' + '" class="btn-floating btn-flat waves-effect waves-light red"><i class="fa fa-times"></i></button>'
	  	}],
	    "dom": 'T<"clear">lfrtip',
		"bLengthChange": false
	});
		 
	$('#layers-table tbody').on('click', 'button', function (){
		var row = table.row($(this).parents('tr'));
	    var data = row.data();     
	    if (this.name == "button-update-library") {
	        updateLibrary(data);
	    } 
	    if (this.name == "button-remove-library") {
	        removeLibrary(data);
	    } 
	});
		

	function updateLibrary(data){
		location.href = '/gvsigonline/library_add/' + data[0] + '/';
	}
		
	function removeLibrary(data){
		location.href = '/gvsigonline/library_delete/' + data[0] + '/';
	}
	
	$('#layers-table').on( 'draw.dt', function () {
	    $('select').material_select();
	} );
	
	$('select').material_select();
  
});
</script>
{% endblock %}